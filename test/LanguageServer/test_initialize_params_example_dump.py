from .initialize_params_example import initialize_params_example, path_encode_colon
from Typhon.Driver.debugging import get_project_root

sample_dir = get_project_root() / "test" / "Execute" / "RunFileTest"


params_dump = f"InitializeParams(capabilities=ClientCapabilities(workspace=WorkspaceClientCapabilities(apply_edit=True, workspace_edit=WorkspaceEditClientCapabilities(document_changes=True, resource_operations=(<ResourceOperationKind.Create: 'create'>, <ResourceOperationKind.Rename: 'rename'>, <ResourceOperationKind.Delete: 'delete'>), failure_handling=<FailureHandlingKind.TextOnlyTransactional: 'textOnlyTransactional'>, normalizes_line_endings=True, change_annotation_support=ChangeAnnotationsSupportOptions(groups_on_label=True), metadata_support=None, snippet_edit_support=None), did_change_configuration=DidChangeConfigurationClientCapabilities(dynamic_registration=True), did_change_watched_files=DidChangeWatchedFilesClientCapabilities(dynamic_registration=True, relative_pattern_support=True), symbol=WorkspaceSymbolClientCapabilities(dynamic_registration=True, symbol_kind=ClientSymbolKindOptions(value_set=(<SymbolKind.File: 1>, <SymbolKind.Module: 2>, <SymbolKind.Namespace: 3>, <SymbolKind.Package: 4>, <SymbolKind.Class: 5>, <SymbolKind.Method: 6>, <SymbolKind.Property: 7>, <SymbolKind.Field: 8>, <SymbolKind.Constructor: 9>, <SymbolKind.Enum: 10>, <SymbolKind.Interface: 11>, <SymbolKind.Function: 12>, <SymbolKind.Variable: 13>, <SymbolKind.Constant: 14>, <SymbolKind.String: 15>, <SymbolKind.Number: 16>, <SymbolKind.Boolean: 17>, <SymbolKind.Array: 18>, <SymbolKind.Object: 19>, <SymbolKind.Key: 20>, <SymbolKind.Null: 21>, <SymbolKind.EnumMember: 22>, <SymbolKind.Struct: 23>, <SymbolKind.Event: 24>, <SymbolKind.Operator: 25>, <SymbolKind.TypeParameter: 26>)), tag_support=ClientSymbolTagOptions(value_set=(<SymbolTag.Deprecated: 1>,)), resolve_support=ClientSymbolResolveOptions(properties=('location.range',))), execute_command=ExecuteCommandClientCapabilities(dynamic_registration=True), workspace_folders=True, configuration=True, semantic_tokens=SemanticTokensWorkspaceClientCapabilities(refresh_support=True), code_lens=CodeLensWorkspaceClientCapabilities(refresh_support=True), file_operations=FileOperationClientCapabilities(dynamic_registration=True, did_create=True, will_create=True, did_rename=True, will_rename=True, did_delete=True, will_delete=True), inline_value=InlineValueWorkspaceClientCapabilities(refresh_support=True), inlay_hint=InlayHintWorkspaceClientCapabilities(refresh_support=True), diagnostics=DiagnosticWorkspaceClientCapabilities(refresh_support=True), folding_range=FoldingRangeWorkspaceClientCapabilities(refresh_support=True), text_document_content=None), text_document=TextDocumentClientCapabilities(synchronization=TextDocumentSyncClientCapabilities(dynamic_registration=True, will_save=True, will_save_wait_until=True, did_save=True), filters=None, completion=CompletionClientCapabilities(dynamic_registration=True, completion_item=ClientCompletionItemOptions(snippet_support=True, commit_characters_support=True, documentation_format=(<MarkupKind.Markdown: 'markdown'>, <MarkupKind.PlainText: 'plaintext'>), deprecated_support=True, preselect_support=True, tag_support=CompletionItemTagOptions(value_set=(<CompletionItemTag.Deprecated: 1>,)), insert_replace_support=True, resolve_support=ClientCompletionItemResolveOptions(properties=('documentation', 'detail', 'additionalTextEdits')), insert_text_mode_support=ClientCompletionItemInsertTextModeOptions(value_set=(<InsertTextMode.AsIs: 1>, <InsertTextMode.AdjustIndentation: 2>)), label_details_support=True), completion_item_kind=ClientCompletionItemOptionsKind(value_set=(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25)), insert_text_mode=<InsertTextMode.AdjustIndentation: 2>, context_support=True, completion_list=CompletionListCapabilities(item_defaults=('commitCharacters', 'editRange', 'insertTextFormat', 'insertTextMode', 'data'), apply_kind_support=None)), hover=HoverClientCapabilities(dynamic_registration=True, content_format=(<MarkupKind.Markdown: 'markdown'>, <MarkupKind.PlainText: 'plaintext'>)), signature_help=SignatureHelpClientCapabilities(dynamic_registration=True, signature_information=ClientSignatureInformationOptions(documentation_format=(<MarkupKind.Markdown: 'markdown'>, <MarkupKind.PlainText: 'plaintext'>), parameter_information=ClientSignatureParameterInformationOptions(label_offset_support=True), active_parameter_support=True, no_active_parameter_support=None), context_support=True), declaration=DeclarationClientCapabilities(dynamic_registration=True, link_support=True), definition=DefinitionClientCapabilities(dynamic_registration=True, link_support=True), type_definition=TypeDefinitionClientCapabilities(dynamic_registration=True, link_support=True), implementation=ImplementationClientCapabilities(dynamic_registration=True, link_support=True), references=ReferenceClientCapabilities(dynamic_registration=True), document_highlight=DocumentHighlightClientCapabilities(dynamic_registration=True), document_symbol=DocumentSymbolClientCapabilities(dynamic_registration=True, symbol_kind=ClientSymbolKindOptions(value_set=(<SymbolKind.File: 1>, <SymbolKind.Module: 2>, <SymbolKind.Namespace: 3>, <SymbolKind.Package: 4>, <SymbolKind.Class: 5>, <SymbolKind.Method: 6>, <SymbolKind.Property: 7>, <SymbolKind.Field: 8>, <SymbolKind.Constructor: 9>, <SymbolKind.Enum: 10>, <SymbolKind.Interface: 11>, <SymbolKind.Function: 12>, <SymbolKind.Variable: 13>, <SymbolKind.Constant: 14>, <SymbolKind.String: 15>, <SymbolKind.Number: 16>, <SymbolKind.Boolean: 17>, <SymbolKind.Array: 18>, <SymbolKind.Object: 19>, <SymbolKind.Key: 20>, <SymbolKind.Null: 21>, <SymbolKind.EnumMember: 22>, <SymbolKind.Struct: 23>, <SymbolKind.Event: 24>, <SymbolKind.Operator: 25>, <SymbolKind.TypeParameter: 26>)), hierarchical_document_symbol_support=True, tag_support=ClientSymbolTagOptions(value_set=(<SymbolTag.Deprecated: 1>,)), label_support=True), code_action=CodeActionClientCapabilities(dynamic_registration=True, code_action_literal_support=ClientCodeActionLiteralOptions(code_action_kind=ClientCodeActionKindOptions(value_set=('', 'quickfix', 'refactor', 'refactor.extract', 'refactor.inline', 'refactor.rewrite', 'source', 'source.organizeImports'))), is_preferred_support=True, disabled_support=True, data_support=True, resolve_support=ClientCodeActionResolveOptions(properties=('edit',)), honors_change_annotations=True, documentation_support=None, tag_support=None), code_lens=CodeLensClientCapabilities(dynamic_registration=True, resolve_support=None), document_link=DocumentLinkClientCapabilities(dynamic_registration=True, tooltip_support=True), color_provider=DocumentColorClientCapabilities(dynamic_registration=True), formatting=DocumentFormattingClientCapabilities(dynamic_registration=True), range_formatting=DocumentRangeFormattingClientCapabilities(dynamic_registration=True, ranges_support=True), on_type_formatting=DocumentOnTypeFormattingClientCapabilities(dynamic_registration=True), rename=RenameClientCapabilities(dynamic_registration=True, prepare_support=True, prepare_support_default_behavior=<PrepareSupportDefaultBehavior.Identifier: 1>, honors_change_annotations=True), folding_range=FoldingRangeClientCapabilities(dynamic_registration=True, range_limit=5000, line_folding_only=True, folding_range_kind=ClientFoldingRangeKindOptions(value_set=('comment', 'imports', 'region')), folding_range=ClientFoldingRangeOptions(collapsed_text=False)), selection_range=SelectionRangeClientCapabilities(dynamic_registration=True), publish_diagnostics=PublishDiagnosticsClientCapabilities(version_support=False, related_information=True, tag_support=ClientDiagnosticsTagOptions(value_set=(<DiagnosticTag.Unnecessary: 1>, <DiagnosticTag.Deprecated: 2>)), code_description_support=True, data_support=True), call_hierarchy=CallHierarchyClientCapabilities(dynamic_registration=True), semantic_tokens=SemanticTokensClientCapabilities(requests=ClientSemanticTokensRequestOptions(range=True, full=ClientSemanticTokensRequestFullDelta(delta=True)), token_types=('namespace', 'type', 'class', 'enum', 'interface', 'struct', 'typeParameter', 'parameter', 'variable', 'property', 'enumMember', 'event', 'function', 'method', 'macro', 'keyword', 'modifier', 'comment', 'string', 'number', 'regexp', 'operator', 'decorator'), token_modifiers=('declaration', 'definition', 'readonly', 'static', 'deprecated', 'abstract', 'async', 'modification', 'documentation', 'defaultLibrary'), formats=(<TokenFormat.Relative: 'relative'>,), dynamic_registration=True, overlapping_token_support=False, multiline_token_support=False, server_cancel_support=True, augments_syntax_tokens=True), linked_editing_range=LinkedEditingRangeClientCapabilities(dynamic_registration=True), moniker=None, type_hierarchy=TypeHierarchyClientCapabilities(dynamic_registration=True), inline_value=InlineValueClientCapabilities(dynamic_registration=True), inlay_hint=InlayHintClientCapabilities(dynamic_registration=True, resolve_support=ClientInlayHintResolveOptions(properties=('tooltip', 'textEdits', 'label.tooltip', 'label.location', 'label.command'))), diagnostic=DiagnosticClientCapabilities(dynamic_registration=True, related_document_support=False, related_information=None, tag_support=None, code_description_support=None, data_support=None), inline_completion=InlineCompletionClientCapabilities(dynamic_registration=True)), notebook_document=NotebookDocumentClientCapabilities(synchronization=NotebookDocumentSyncClientCapabilities(dynamic_registration=True, execution_summary_support=True)), window=WindowClientCapabilities(work_done_progress=True, show_message=ShowMessageRequestClientCapabilities(message_action_item=ClientShowMessageActionItemOptions(additional_properties_support=True)), show_document=ShowDocumentClientCapabilities(support=True)), general=GeneralClientCapabilities(stale_request_support=StaleRequestSupportOptions(cancel=True, retry_on_content_modified=('textDocument/semanticTokens/full', 'textDocument/semanticTokens/range', 'textDocument/semanticTokens/full/delta')), regular_expressions=RegularExpressionsClientCapabilities(engine='ECMAScript', version='ES2020'), markdown=MarkdownClientCapabilities(parser='marked', version='1.1.0', allowed_tags=None), position_encodings=('utf-16',)), experimental=None), process_id=None, client_info=ClientInfo(name='Visual Studio Code', version='1.108.0'), locale='en', root_path='{str(sample_dir.resolve()).replace('\\', '\\\\')}', root_uri='{path_encode_colon(sample_dir.resolve().as_uri())}', initialization_options=None, trace=<TraceValue.Off: 'off'>, work_done_token=None, workspace_folders=(WorkspaceFolder(uri='{path_encode_colon(sample_dir.resolve().as_uri())}', name='RunFileTest'),))"


def test_initialize_params_example_dump():
    result = initialize_params_example(sample_dir)
    print(f"initialize_params_example = {str(result)}")
    print(f"params_dump = {params_dump}")
    assert str(result) == params_dump
